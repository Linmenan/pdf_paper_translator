# æ ‡æ³¨å·¥å…·

æ ‡æ³¨å·¥å…·è¾…åŠ©äººå·¥è¿›è¡Œ pdf æ–‡çŒ®é¡µé¢ä¸­ä¸»è¦å…ƒç´ çš„æ ‡æ³¨ã€‚ä¸»è¦å®ç°å¯è§†åŒ–ï¼Œæ–°å¢æ ‡æ³¨ï¼Œåˆ é™¤æ ‡æ³¨ï¼Œä¿®æ”¹æ ‡æ³¨ï¼Œå†å²æ ‡æ³¨æ–‡ä»¶åŠ è½½ç­‰åŠŸèƒ½ã€‚

## èƒŒæ™¯ä»‹ç»

æ–‡çŒ® pdf é¡µé¢ä¸­æŸäº›è¦ç´ ä½¿ç”¨ PyMuPDF å·¥å…·è¿›è¡Œæå–æ—¶å­˜åœ¨å›°éš¾ï¼Œæˆ–è€…æå–ä¼šç ´åå…¶åŸæœ‰æ ·å¼ï¼Œå› æ­¤ï¼Œåœ¨å·¥ç¨‹ä¸­åˆ›å»ºå¯è§†åŒ–æ ‡æ³¨å·¥å…·ï¼Œäººå·¥å°†é¡µé¢å…ƒç´ èŒƒå›´æ˜ç¡®å‘ŠçŸ¥ï¼Œé¢„å…ˆæ‹†åˆ†åæå–ï¼Œæé«˜å·¥ä½œæ•ˆç‡ä¸å‡†ç¡®åº¦ã€‚
é¡µé¢è¦ç´ å¤§ç±»åŒ…å«ï¼š

- å›¾
  - id[å”¯ä¸€]ï¼šæ–‡ç« å†…æ ‡å·
  - æˆªå›¾èŒƒå›´[è‡³å°‘ä¸€ä¸ª]ï¼š å›¾æœ¬ä½“ ï¼ˆè¯¥èŒƒå›´ä»…éœ€æˆªå›¾ï¼Œä½œä¸ºèµ„æºä¿å­˜ï¼Œåç»­ç»“æœä¸­åŠ è½½ï¼‰
  - æ ‡é¢˜[è‡³å°‘ä¸€ä¸ª]ï¼š å›¾åç§°ä¸å…¶è¯´æ˜æ–‡å­—ï¼ˆè¯¥èŒƒå›´çš„æ–‡å­—éœ€ PyMuPDF å·¥å…·æå–ï¼‰
- è¡¨
  - id[å”¯ä¸€]ï¼šæ–‡ç« å†…æ ‡å·
  - æˆªå›¾èŒƒå›´[è‡³å°‘ä¸€ä¸ª]ï¼š è¡¨æœ¬ä½“ ï¼ˆè¯¥èŒƒå›´ä»…éœ€æˆªå›¾ï¼Œä½œä¸ºèµ„æºä¿å­˜ï¼Œåç»­ç»“æœä¸­åŠ è½½ï¼‰
  - æ ‡é¢˜[è‡³å°‘ä¸€ä¸ª]ï¼š è¡¨åç§°ä¸å…¶è¯´æ˜æ–‡å­—ï¼ˆè¯¥èŒƒå›´çš„æ–‡å­—éœ€ PyMuPDF å·¥å…·æå–ï¼‰
- å…¬å¼
  - id[å”¯ä¸€]ï¼šæ–‡ç« å†…æ ‡å·
  - æˆªå›¾èŒƒå›´[è‡³å°‘ä¸€ä¸ª]ï¼š å…¬å¼æœ¬ä½“ ï¼ˆè¯¥èŒƒå›´ä»…éœ€æˆªå›¾ï¼Œä½œä¸ºèµ„æºä¿å­˜ï¼Œåç»­ç»“æœä¸­åŠ è½½ï¼‰
- ç®—æ³•ï¼ˆä¼ªä»£ç ï¼‰
  - id[å”¯ä¸€]ï¼šæ–‡ç« å†…æ ‡å·
  - æˆªå›¾èŒƒå›´[è‡³å°‘ä¸€ä¸ª]ï¼š ç®—æ³•æœ¬ä½“ ï¼ˆè¯¥èŒƒå›´ä»…éœ€æˆªå›¾ï¼Œä½œä¸ºèµ„æºä¿å­˜ï¼Œåç»­ç»“æœä¸­åŠ è½½ï¼‰
  - æ ‡é¢˜[è‡³å°‘ä¸€ä¸ª]ï¼š ç®—æ³•è¯´æ˜æ–‡å­—ï¼ˆè¯¥èŒƒå›´çš„æ–‡å­—éœ€ PyMuPDF å·¥å…·æå–ï¼‰
- æ–‡ç« æ ‡é¢˜[å”¯ä¸€]
  - æ ‡é¢˜æ­£æ–‡[è‡³å°‘ä¸€ä¸ª]ï¼š å†…å®¹æ–‡å­—ï¼ˆè¯¥èŒƒå›´çš„æ–‡å­—éœ€ PyMuPDF å·¥å…·æå–ï¼‰
- ä½œè€…æœºæ„[å”¯ä¸€]
  - ä½œè€…æœºæ„æ­£æ–‡[è‡³å°‘ä¸€ä¸ª]ï¼š å†…å®¹æ–‡å­—ï¼ˆè¯¥èŒƒå›´çš„æ–‡å­—éœ€ PyMuPDF å·¥å…·æå–ï¼‰
- é®ç½©[æ¯é¡µå”¯ä¸€]
  - é®ç½©èŒƒå›´[ä¸å®šæ•°é‡]ï¼šæœ¬é¡µä¸­å‘Šè¯‰ PyMuPDF å·¥å…·éœ€è¦ä»æ­£æ–‡æå–ä¸­å¿½ç•¥çš„èŒƒå›´
- ç« èŠ‚å[ä¸å®šæ•°é‡]
  - ç« èŠ‚æ ‡é¢˜[å”¯ä¸€]ï¼šå†…å®¹æ–‡å­—ï¼ˆè¯¥èŒƒå›´çš„æ–‡å­—éœ€ PyMuPDF å·¥å…·æå–å¹¶ä¸”ç”±ç‰¹æ®Šæ ‡è®° [[HEADER:]] åŒ…å›´å¤„ç†ï¼‰
- æ­£æ–‡[æ¯é¡µå”¯ä¸€]
  - æ­£æ–‡å†…å®¹ï¼š å†…å®¹æ–‡å­—ï¼ˆè¯¥èŒƒå›´çš„æ–‡å­—éœ€ PyMuPDF å·¥å…·æå–ï¼‰æ˜¯æ•´ä¸ªæ–‡ä»¶ä¸­æ–‡å­—æœ€å¤šçš„èŒƒå›´ ç‰¹æ€§ï¼š**æ­£æ–‡æ¡†è‡ªåŠ¨ç»§æ‰¿**: å½“ç¿»è‡³æ–°çš„ä¸€é¡µä¸”è¯¥é¡µå°šæœªæ ‡æ³¨â€œæ­£æ–‡èŒƒå›´ (ContentArea)â€æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å¤åˆ¶ä¸Šä¸€é¡µçš„æ­£æ–‡æ¡†ä½ç½®ã€‚è¿™åœ¨å¤„ç†æ¿å¼å›ºå®šçš„è®ºæ–‡æ—¶å¯æå¤§å‡å°‘é‡å¤æ“ä½œã€‚

[TODO] å¢åŠ è®¾è®¡ï¼šæ ‡æ³¨é˜¶æ®µå¢åŠ ä¸€ä¸ªé€‰é¡¹è®°å½•å½“å‰æ–‡çŒ®æ˜¯å¦ä¸ºåŒæ æ’ç‰ˆï¼Œé»˜è®¤å€¼ä¸ºåŒæ 

PyMuPDF å·¥å…·ä¼šå°†æ ‡æ³¨å¥½çš„æ­£æ–‡å†…å®¹æŒ‰ç…§æ–‡ç« æ’ç‰ˆé¡ºåºï¼ˆå•æ ä»ä¸Šåˆ°ä¸‹ï¼ŒåŒæ å…ˆå·¦æ ï¼Œåå³æ ï¼Œå„æ å†…ä»ä¸Šåˆ°ä¸‹ï¼‰å°†å¤šé¡µæ­£æ–‡å†…å®¹æå–å¹¶ä¸”é‡æ–°åˆ†æ®µï¼Œåˆ†æ®µæ¶ˆé™¤åŸæ–‡ä¸­ç”±äºç‰ˆé¢é™åˆ¶å¯¼è‡´çš„å•è¯è¢«åˆ†å¼€ï¼Œå¥å­è¢«åˆ†å¼€çš„æƒ…å†µã€‚ç„¶åæŒ‰ç…§æ®µè½å†…å®¹é•¿åº¦é˜ˆå€¼ï¼Œä»¥å®Œæ•´çš„å¥å­ä¸ºæœ€å°å•ä½è¿›è¡Œæ®µè½æ‹†åˆ†ã€‚è¿˜åº”è¯¥æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸€é˜¶æ®µéœ€è¦å°†äººå·¥æ ‡æ³¨çš„æ–‡ç« å†…è¦ç´ æ‰€å¤„çš„æ®µè½é—´ä½ç½®æ‰“å¥½æ ‡è®°ï¼Œç”¨äºåç»­ç»“æœä¸­èµ„æºæ’å…¥ä½ç½®å‚è€ƒï¼ˆå–æ ‡è®°ä½ç½®ä¸æ–‡å†…å¼•ç”¨ä½ç½®é å‰çš„ä½œä¸ºæ’å…¥ä½ç½®ï¼‰ã€‚
ç‰¹ä¾‹çš„æ˜¯å‚è€ƒæ–‡çŒ® Reference ä¹‹åçš„å‚è€ƒæ–‡çŒ®ï¼Œç›´åˆ°é™„å½• Appendixï¼ˆè‹¥æœ‰ï¼‰æˆ–è€…æ–‡æœ«ä¹‹é—´çš„å†…å®¹æ— éœ€ç¿»è¯‘ï¼Œåªéœ€è¦æŒ‰ç…§æ¯ä¸ª[index]ä½œä¸ºå¼€å¤´å¯¹å‚è€ƒæ–‡çŒ®æ¯ä¸ªæ¢è¡Œæ˜¾ç¤ºå³å¯ã€‚

## é¡µé¢è¦ç´ ï¼š

- å·¦ä¾§å·¥å…·æ ï¼š
  - å·¥å…·æŒ‰é’®ï¼šå·¥å…·ç±»åˆ«ï¼Œè¯†åˆ«é¢œè‰²ï¼Œå¿«æ·é”®ï¼Œä¹Ÿå¯é¼ æ ‡ç‚¹é€‰ TODO æ–°å»º ID æŒ‰é’®æ²¡å¿…è¦ï¼Œåˆ æ‰
  - å·²æ ‡æ³¨è¦ç´ åˆ—è¡¨ï¼š æ˜¾ç¤ºå½“å‰å­˜åœ¨çš„è¦ç´ åˆ—è¡¨ï¼Œåœ¨æ€»è§ˆæ¨¡å¼ä¸‹æ˜¾ç¤ºæ‰€æœ‰å…ƒç´ ï¼ˆæŒ‰ç…§ç±»åˆ«åˆ†ç±»ï¼Œæ˜¾ç¤º idï¼‰ï¼›åœ¨æŸä¸€å·¥å…·æ¨¡å¼ä¸‹æ˜¾ç¤ºå½“å‰ç±»åˆ«æ‰€æœ‰æ ‡æ³¨æ¡†ä»¥åŠå…¶ idï¼Œå„ä¸ªå…ƒç´ å†…å«åŒºåŸŸæ•°é‡ï¼ˆåˆ†ä¸ºæˆªå›¾åŒºåŸŸä¸æ–‡å­—åŒºåŸŸï¼‰ï¼›åœ¨ä¿®æ”¹ç¼–è¾‘æ¨¡å¼ä¸‹åªæ˜¾ç¤ºå½“å‰æ¡†çš„ id è®¾ç½®è¾“å…¥æ¡†ã€‚æ³¨æ„ï¼š**å³æ—¶ç”Ÿæ•ˆ**:ä¿®æ”¹ ID è¾“å…¥æ¡†æ—¶ï¼Œç”»å¸ƒä¸Šçš„æ ‡ç­¾ä¼šå®æ—¶æ›´æ–°ï¼Œæ— éœ€å›è½¦ç¡®è®¤ã€‚**é”®ç›˜æ”¯æŒ**ï¼šå³ä½¿å…‰æ ‡åœ¨è¾“å…¥æ¡†å†…ï¼ŒæŒ‰ä¸‹ `Esc` é”®ä¹Ÿèƒ½å¼ºåˆ¶ä½¿è¾“å…¥æ¡†å¤±ç„¦å¹¶å–æ¶ˆé€‰ä¸­çŠ¶æ€ï¼Œæ–¹ä¾¿å¿«é€Ÿåˆ‡æ¢å·¥å…·ã€‚
  - é¡µé¢åºå·ï¼šæ˜¾ç¤ºå½“å‰é¡µé¢åºå·ä¸æ€»é¡µæ•°ï¼Œä¹Ÿå¯ç‚¹å‡»è¿›è¡Œä¸Šä¸‹ç¿»é¡µ

## æ ‡æ³¨æ¡†å„çŠ¶æ€ä¸‹çš„æ˜¾ç¤ºæ•ˆæœä¸äº¤äº’å±æ€§ï¼š

1ã€æ€»ä½“é¢„è§ˆä¸å¯é€‰ä¸­ï¼šä¸é€æ˜ä¸å¯é€‰ä¸­

2ã€å…¶ä»–ç±»åˆ«é¢„è§ˆä¸å¯é€‰ä¸­ï¼šé€æ˜åº¦ 70%ä¸å¯é€‰ä¸­

3ã€å€™é€‰é¢„è§ˆå¯é€‰ä¸­ï¼šé€æ˜åº¦ 80%å¯é€‰ä¸­

4ã€å½“å‰é€‰ä¸­ï¼šä¸é€æ˜ï¼Œå·²é€‰ä¸­å¯ç¼–è¾‘

å®šä¹‰å½“å‰æ“ä½œå±‚çº§:
A:å…¨å±€é¢„è§ˆï¼šé¼ æ ‡æ— ä»»ä½•æ ‡æ³¨å·¥å…·ï¼Œæ‰€æœ‰å·²æ ‡æ³¨çš„æ¡†æŒ‰ç…§ 1 æ˜¾ç¤º
B:æŸç±»åˆ«å·¥å…·æ¨¡å¼ï¼šå…‰æ ‡æ˜¾ç¤ºå½“å‰æ ‡æ³¨å·¥å…·ï¼Œidï¼ŒåŠç»†åˆ†ç±»åˆ«ï¼ˆTODOï¼šæ”¹ä¸ºæ±‰å­—æ˜¾ç¤ºï¼‰ï¼Œé¡µé¢ä¸Šè¦ç´ æŒ‰ç…§å…¶å¤§ç±»ä½¿ç”¨ 2ï¼Œ3 æ˜¾ç¤º
Cï¼šé€‰ä¸­ä¿®æ”¹æ¨¡å¼ï¼šå…‰æ ‡æ˜¾ç¤ºå½“å‰é€‰ä¸­ç›®æ ‡çš„ç±»åˆ« id åŠç»†åˆ†ç±»åˆ«ï¼ˆæ­¤æ—¶ä»…æ”¯æŒå¯¹è¿™ä¸ªæ¡†çš„æ“ä½œï¼Œå¦‚ï¼šæ”¹ idï¼Œç§»åŠ¨ï¼Œæ”¹å˜è¾¹ç¼˜è§’ç‚¹ä½ç½®ï¼Œåˆ é™¤ï¼‰æ³¨æ„ï¼šæ”¹ id ä¸åˆ é™¤å±äºæ˜“å‘ç”Ÿ bug çš„æ“ä½œï¼Œä¿®æ”¹ id åï¼ŒåŸæœ¬å·¦ä¾§çŠ¶æ€æ ä¸å·¥ä½œåŒºåŸŸçš„è§’ç­¾å†…å®¹è¦å¯¹åº”æ”¹å˜ï¼Œå¹¶ä¸”ä¸èƒ½ä¸¢å¤±å¯¹è¯¥ç›®æ ‡çš„æ•æ‰ã€‚[FIXME]**é€‰ä¸­ Bug**: åœ¨åˆ—è¡¨æˆ–ç”»å¸ƒä¸­ä¿®æ”¹ ID åï¼Œè‹¥ ID ä¸ç°æœ‰ ID é‡å¤ï¼Œå¯èƒ½å¯¼è‡´è¯¥å…ƒç´ æ— æ³•å†æ¬¡è¢«é€‰ä¸­ã€‚éœ€åˆ·æ–°é¡µé¢æ¢å¤ã€‚**å³æ—¶å“åº”**: ID è¾“å…¥æ¡†æ”¯æŒ `input` äº‹ä»¶ï¼Œä¿®æ”¹æ•°å€¼å³åˆ»æ¸²æŸ“ç”»å¸ƒæ ‡ç­¾ï¼Œæ— éœ€å›è½¦ã€‚

çŠ¶æ€è·³è½¬åº”éµå¾ªå¦‚ä¸‹ï¼š
æ€»è§ˆ->æŸç±»åˆ«å·¥å…·æ¨¡å¼ï¼šæŒ‰ä¸‹å¯¹åº”å·¥å…·å¿«æ·é”®æˆ–è€…ç‚¹å‡»å·¦ä¾§å·¥å…·æ ä¸­çš„å·¥å…·æŒ‰é’®æˆ–è€…ç‚¹å‡»å·¦ä¾§åˆ—è¡¨ä¸­çš„å…ƒç´ 
æŸç±»åˆ«å·¥å…·æ¨¡å¼->æ€»è§ˆï¼šæŒ‰ä¸‹ Esc
æŸç±»åˆ«å·¥å…·æ¨¡å¼->é€‰ä¸­ä¿®æ”¹æ¨¡å¼:åœ¨å·¥ä½œåŒºç‚¹å‡»æŸä¸ªè¦ç´ æ¡†æˆ–è€…ç‚¹å‡»å·¦ä¾§åˆ—è¡¨ä¸­çš„è¦ç´ 
é€‰ä¸­ä¿®æ”¹æ¨¡å¼->æŸç±»åˆ«å·¥å…·æ¨¡å¼ï¼šæŒ‰ä¸‹ Esc

## âŒ¨ï¸ å¿«æ·é”®ä¸å›¾ä¾‹å¯¹ç…§è¡¨ (Controls & Visual Legend)

| æŒ‰é”®          | åŠŸèƒ½ / ç±»åˆ« (Type)                   | é¢œè‰² (Hex)   | ä½œç”¨èŒƒå›´       |
| :------------ | :----------------------------------- | :----------- | :------------- |
| `1`           | å›¾ (Figure)                          | ğŸŸ¥ `#e74c3c` | Canvas         |
| `2`           | è¡¨ (Table)                           | ğŸŸ¦ `#3498db` | Canvas         |
| `3`           | å¼ (Equation)                        | ğŸŸ© `#27ae60` | Canvas         |
| `4`           | ç®— (Algorithm)                       | ğŸŸª `#9b59b6` | Canvas         |
| `5`           | æ ‡é¢˜ (Title)                         | ğŸŸ§ `#d35400` | Canvas         |
| `6`           | ä½œè€… (Author)                        | ğŸŸ¦ `#1abc9c` | Canvas         |
| `7`           | é®ç½© (Mask)                          | â¬œ `#7f8c8d` | Canvas         |
| `8`           | ç« èŠ‚ (Header)                        | ğŸŸ£ `#8e44ad` | Canvas         |
| `0`           | æ­£æ–‡èŒƒå›´ (ContentArea)               | ğŸŸ¨ `#f1c40f` | Canvas         |
| `Q`           | åˆ‡æ¢å½“å‰å¾…æ ‡æ³¨çš„è§’è‰² (Body/Caption)  | -            | Canvas         |
| `Del`         | åˆ é™¤é€‰ä¸­æ ‡æ³¨æ¡†                       | -            | Canvas         |
| `Space` / `â†’` | ä¸‹ä¸€é¡µ                               | -            | Canvas         |
| `â†`           | ä¸Šä¸€é¡µ                               | -            | Canvas         |
| `Ctrl + S`    | ä¿å­˜å¸ƒå±€é…ç½®                         | -            | å…¨å±€           |
| `Ctrl + Z`    | æ’¤é”€æ“ä½œ                             | -            | [TODO]æ”¹ä¸ºå…¨å±€ |
| `Esc`         | å–æ¶ˆå½“å‰å·¥å…· / å–æ¶ˆé€‰ä¸­ / è¾“å…¥æ¡†å¤±ç„¦ | -            | å…¨å±€           |

åœ¨å·¥å…·çš„æ“ä½œç•Œé¢å†…å®Œå…¨å±è”½æµè§ˆå™¨é»˜è®¤`Ctrl + Z`ï¼Œ`Ctrl + S`ç­‰å¿«æ·é”®å†²çªè¡Œä¸ºã€‚
