# 结果预览与纠错 (Result Preview)

结果预览页面不仅是最终产物的展示窗口，更是一个支持 人机回环 (Human-in-the-Loop) 的交互式工作台。在这里，用户可以阅读图文并茂的 HTML 报告，并对 AI 的翻译结果进行微调。

## 1. 核心特性

### A. 所见即所得的 HTML 报告

系统生成的报告是 半离线 的 HTML 文件，保存在 vis_output/{paper_name}/ 目录下。

图文混排: 利用 Step 1 提取的坐标和截图，将插图 (Figure)、表格 (Table) 插入到正文引用的自然段落附近，还原论文阅读体验。

样式还原: 区分显示文章元数据 (Meta)、章节标题 (Header) 和正文段落。

资源索引: 报告末尾附带参考文献列表和未引用的图片资源。

### B. 交互式纠错 (Interactive Correction)

这是本系统区别于普通翻译工具的核心功能。

点击进入编辑: 在报告中，鼠标悬停在任何一段中文译文上，该段落会高亮显示。点击即可弹出的 "人工纠错向导" 面板。

输入指引: 在面板中输入你的修改意见（例如：“把'鲁棒性'改为'稳健性'”，“这句话逻辑反了”）。

保存反馈: 点击保存后，前端会将你的指引 (user_hint) 和当前的旧译文 (old_trans) 一并发送回后端，并更新 \_llm_cache.json。

状态标记: 被修改过的段落会显示 "💡 待重译" 标记。

### C. 触发重译 (Re-run)

完成所有人工修改后，点击顶部导航栏的 "🔄 刷新报告" 按钮。

后端逻辑: 系统会重新扫描任务列表，发现带有 user_hint 且状态为 pending 的任务。

模型切换: 对于纠错任务，系统会自动切换到 更强模型 (如 Qwen2.5-14B/32B)，以更高的逻辑能力处理用户的修改意见。

局部更新: 仅重译被修改的段落，其他段落保持不变，速度极快。

## 2. 文件结构与离线阅读

生成的报告文件夹结构如下，具有良好的可移植性：

vis_output/  
└── Zhang_CarPlanner_2025/ # 论文专属目录  
├── Zhang_CarPlanner_Report.html # [入口] 主报告文件  
└── assets/ # [资源] 图片文件夹  
├── Figure_1.png  
├── Table_1.png  
└── ...

注意: 如果只需要阅读，可以直接将该文件夹打包发送给他人。只有在使用“纠错”功能时，才需要依赖 Python 后端服务。

## 3. 页面交互逻辑

Iframe 嵌入: 为了隔离样式冲突，HTML 报告通过 \<iframe\> 嵌入在 Vue 应用中。

跨域通信: 前端通过 API 与后端交互，触发重生成后，自动刷新 Iframe 的 src 链接（添加时间戳 ?t=... 防止缓存）。
